10 DIM CUR(9)
       SCREEN 7
20     DATA 0,14,0
       DATA 14,0,14
       DATA 0,14,0
       FOR Y=1 TO 3
       FOR X=1 TO 3
       READ A
       PSET(X,Y),A
       NEXT X
       NEXT Y
       GET(1,1)-(3,3),CUR
30 CLS
31 PRINT "<1> EDIT NEW"
32 PRINT "<2> SELECT LOADING FILE"
	PRINT "<3> TO SEE FILES"
	PRINT "<4> SCREEN 640 X 480"
33 A$=INKEY$
	 IF A$="2" THEN GOTO 80
	 IF A$="1" THEN GOTO 40
	 IF A$="3" THEN FILES
	 IF A$="4" THEN SCR=2
	 IF A$="x" THEN END
	 GOTO 33

40 INPUT "FILE NAME";FL$
41	INPUT "HEIGH :";H
	INPUT "WIDTH :";W
	IF H>160 OR W>160 THEN PRINT "TOO BIG 120-MAX":GOTO 41
	OPEN FL$ FOR OUTPUT AS #1
	CLS
	IF SCR=2 THEN SCREEN 12
50	LINE(9,9)-(10+W,10+H),8,B
	X=10:Y=10:XP=10:YP=10
	FOR C=1 TO 15
	LINE (280,C*10+40)-(310,C*10+50),C,BF
	IF C MOD 5=0 THEN LINE (280,C*10+50)-(310,C*10+50),0
	NEXT C

60	LINE(1,YP)-(8,YP),0
	LINE(XP,1)-(XP,8),0
	LINE(11+W,YP)-(18+W,YP),0
	LINE(XP,H+11)-(XP,H+18),0

	LINE(11+W,Y)-(18+W,Y),14
	LINE(X,H+11)-(X,H+18),14
	LINE(1,Y)-(8,Y),14
	LINE(X,1)-(X,8),14
	LOCATE 2,24:PRINT "                "
	LOCATE 2,24:PRINT "(";X-9;",";Y-9;")"
	IF PF=1 THEN PSET(X,Y),CP
	LINE(200,40)-(250,45),CP,BF
61	A$=INKEY$
	IF A$="A" THEN CF=1
	IF A$="a" THEN CF=0
	IF CF=1 THEN PUT(X-1,Y-1),CUR:FOR T=1 TO 100000:NEXT T:PUT(X-1,Y-1),CUR
	IF A$="" THEN GOTO 61
	C=VAL(A$)
	IF A$="=" THEN CP=CP+1:IF CP>15 THEN CP=15
	IF A$="-" THEN CP=CP-1:IF CP<0 THEN CP=0
	IF A$="=" OR A$="-" THEN GOTO 60
	IF A$="Q" THEN C=10
	IF A$="W" THEN C=11
	IF A$="E" THEN C=12
	IF A$="R" THEN C=13
	IF A$="T" THEN C=14
	IF A$="F" THEN GOTO 100
	IF A$="Y" THEN C=15
	IF A$="d" THEN GOTO 90
	IF A$="x" THEN GOTO 70
	IF A$="g" THEN GOTO 110
	IF A$="S" THEN LOCATE 5,24:PRINT "PAINTING:" :PF=1:GOTO 60
	IF A$="s" THEN LOCATE 5,24:PRINT "         ":PF=0:GOTO 60

	IF A$="P" THEN YP=Y:Y=Y-1:MV=1:IF Y<10 THEN Y=10
	IF A$=";" THEN YP=Y:Y=Y+1:MV=1:IF Y>9+H THEN Y=9+H
	IF A$="'" THEN XP=X:X=X+1:MV=1:IF X>9+W THEN X=9+W
	IF A$="L" THEN XP=X:X=X-1:MV=1:IF X<10 THEN X=10
	IF MV=1 THEN MV=0:GOTO 60
	IF PF=1 THEN GOTO 60

	PSET(X,Y),C
	GOTO 61

70	LOCATE 5,24:PRINT "SAVE? Y/N"
71	A$=INKEY$
	IF A$="Y" THEN GOTO 75
	IF A$="N" THEN GOTO 76
	GOTO 71

75  PRINT #1,H
	PRINT #1,W
	FOR Y=1 TO H
	FOR X=1 TO W
	PRINT #1,POINT(X+9,Y+9)
	NEXT X
	NEXT Y
76	CLOSE #1
	END

80 INPUT "FILE NAME:";FL$
	CLS
	OPEN FL$ FOR INPUT AS #2
	INPUT #2,H
	INPUT #2,W

	FOR Y=1 TO H
	FOR X=1 TO W
	INPUT #2,LDF
	PSET (X+9,Y+9),LDF
	NEXT X
	NEXT Y
	CLOSE #2
	OPEN FL$ FOR OUTPUT AS #1
	GOTO 50
90  XC=X-10
	YC=Y-10
	LOCATE 5,24:PRINT "CIRCLE "
	LOCATE 6,24:INPUT "R:";R
	LOCATE 5,24:PRINT "       "
	LOCATE 6,24:PRINT "       "
	FOR XT=1 TO W
	FOR YT=1 TO H
	TR=((XT-XC)^2)+((YT-YC)^2)
	TR=SQR(TR)
	TR=INT(TR)
	IF TR=R THEN PSET (XT+9,YT+9),CP
	NEXT YT
	NEXT XT
	GOTO 61
100 LOCATE 5,24:PRINT "FONT"
	LOCATE 6,24:INPUT C
	FOR XT=1 TO W
	FOR YT=1 TO H
	IF POINT(XT+9,YT+9)=CP THEN PSET(XT+9,YT+9),C
	NEXT YT
	NEXT XT
	LOCATE 5,24:PRINT "    "
	LOCATE 6,24:PRINT "    "
	GOTO 61
110 COUNT=0
	FOR XT=1 TO W
	FOR YT=1 TO H
	IF POINT(XT+9,YT+9)=CP THEN COUNT=COUNT+1
	NEXT YT
	NEXT XT
	LOCATE 5,24:PRINT " ";COUNT
111	A$=INKEY$
	IF A$="" THEN 111
	GOTO 61



