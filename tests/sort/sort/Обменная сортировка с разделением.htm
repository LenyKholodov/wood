<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0043)http://rtfm.vn.ua/prog/tech/sort/sort_7.htm -->
<HTML><HEAD><TITLE>Обменная сортировка с разделением</TITLE>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META content="MSHTML 5.00.2614.3401" name=GENERATOR></HEAD>
<BODY bgColor=#000000 link=#ffffff text=#00ffff>
<P align=right><A href="http://www.linkexchange.ru/users/010865/goto.map" 
target=_blank><IMG alt="Russian LinkExchange Advertising Network" border=0 
height=60 isMap src="" vspace=4 width=468></A></P>
<H2 align=left>&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#ffff80>Обменная сортировка 
с разделением</FONT></H2>
<P align=left><FONT color=#ffffff>&nbsp;</FONT> Данный метод является одним из 
лучших методов внутренней сортировки и весьма эффективен для больших таблиц. 
Целью каждого шага в данном методе является помещение очередной рассматриваемой 
записи на конечную позицию внутри таблицы. Если поступать таким способом, то все 
записи, предшествующие дан-<BR>ной, будут иметь меньший ключ, в то время как все 
последующие - больший. При использовании такого метода таблица всегда делится на 
две подтаблицы. Анологичный процесс может быть применен к каждой из этих 
подтаблиц и повторяться до тех пор, пока все записи не будут установлены на их 
конечные позиции.<BR>Используются два индекса i и j с начальными значениями 
границ таблицы. Сравниваются ключи K[i] и K[j], и если перестановка не 
требуется, то j уменьшается на 1, и процесс повторяется.&nbsp;&nbsp;&nbsp;&nbsp; 
В том&nbsp;&nbsp;&nbsp; случае, когда K[i]&gt;=K[j], записи R[i] и 
R[j]<BR>меняются местами. Затем этот процесс повторяется с i, увеличенным на 1, 
и фиксированным j до тех пор, пока не возникает другая перестановка. В этот 
момент j снова будет уменьшено на 1, а i останется фиксированным, и т.д. Процесс 
выполняется до тех пор, пока i&lt;j.<BR><BR>Каждый раз таблица разбивается на 
две подтаблицы, одна из которых обрабатывается, в то время как границы второй 
запоминаются с тем,&nbsp;&nbsp;&nbsp;&nbsp; чтобы она была обработана позже. В 
этих целях может быть использован стек, представляющий собой матрицу из двух 
столбцов. В первом столбце хранятся нижние границы разделяемых подтаблиц, во 
втором - верхние границы. Всякий раз одна из полученных в результате разделения 
подтаблиц подвергается дальнейшему разделению, а границы другой помещаются в 
свободную строку стека (обычно в стек помещаются границы большей по длине 
таблицы, поскольку это уменьшает требуемый размер стека). Как только завершается 
процесс разделения текущей подтаблицы, т.е. ее длина станет меньше трех, для 
разделения берется подтаблица, границы которой были занесены в стек последними. 
Строка стека, в которой хранились эти границы, освобождается. Процесс 
упорядочения завершается, когда стек полностью освобождается.<BR>Разделение 
следует применять для подтаблиц,&nbsp;&nbsp;&nbsp;&nbsp; длина которых больше 9, 
а короткие подтаюлицы упорядочивать методом вставки.<BR>Стек занимает мало 
места.Например,стек из 20 строк позволяет упорядочить таблицу,содержащую до 
10**7 записей.Кроме того, в современных языках 
программирования&nbsp;&nbsp;&nbsp; при работе рекурсивных программ занесение и 
извлечение из стека выполняется автоматически,поэтому рекомендуется использовать 
именно этот<BR>механизм. Среднее число сравнений для данного алгоритма 
составляет n*log(n)<BR>где n - число записей в сортируемой таблице, m - размер 
подтаблицы, сортируемой методом вставки.<BR><BR>Наихудшей ситуацией при 
использовании рассмотренного алгоритма является случай, когда таблица уже 
отсортирована. При этом число сравнений порядка n , т.е. алгоритм не лучше 
сортировки выборкой.<BR><BR>В качестве примера рассмотрим записи со следующими 
ключами:<BR><BR>42&nbsp;&nbsp;&nbsp; 23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 
11&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR><BR>Ниже приведена последовательность перестановок при перемещении записи 
с ключем 42&nbsp;&nbsp;&nbsp; на его конечную позицию. Подчеркнуты 
ключи,значения которых сравнивались.<BR><BR>42&nbsp;&nbsp;&nbsp; 
23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 11&nbsp;&nbsp;&nbsp; 
36&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>~~~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~<BR>42&nbsp;&nbsp;&nbsp; 23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 
11&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>~~~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~<BR>42&nbsp;&nbsp;&nbsp; 23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 
11&nbsp;&nbsp;&nbsp; 36&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>~~~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~<BR>-----------------------------------<BR>36&nbsp;&nbsp;&nbsp; 
23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 11&nbsp;&nbsp;&nbsp; 
42&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~<BR>36&nbsp;&nbsp;&nbsp; 23&nbsp;&nbsp;&nbsp; 74&nbsp;&nbsp;&nbsp; 
11&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~<BR>-----------------------------------<BR>36&nbsp;&nbsp;&nbsp; 
23&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp; 11&nbsp;&nbsp;&nbsp; 
74&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp;&nbsp; 
94<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~~ ~~~<BR>----------------------------------<BR>36&nbsp;&nbsp;&nbsp; 
23&nbsp;&nbsp;&nbsp; 11&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp; 
74&nbsp;&nbsp;&nbsp;&nbsp; 58&nbsp;&nbsp; 
94<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
~~<BR><BR>В результате&nbsp;&nbsp;&nbsp; записи с исходными ключами разбиты на 
две подтаблицы,а именно,на наборы [36,23,11] и [74,58,94],к которым применяется 
тот же метод.<BR><BR>В качестве разделяющего можно выбрать X - любой элемент 
таблицы,например,средний (l=n/2).Сначала таблица рассматривается слева от X до 
тех пор,пока не обнаружится ключ K[i]&gt;X (K[i]&lt;=X, i:=i+1; если 
K[i]&gt;X,то i фиксируется). Затем таблица просматривается справа,пока 
выполняется K[j]&gt;=X (j:= j-1; если K[j]&lt;X, то j фиксируется).Элементы 
таблицы с ключами K[i] и K[j] меняются местами.Процесс просмотра и обмена 
продолжается до тех пор, пока оба просмотра не встретятся в некоторой позиции 
таблицы. При этом необходимо сравнивать индексы i и j с&nbsp;&nbsp;&nbsp;&nbsp; 
индексом выбранного элемента X ( индекс l) с тем,чтобы процесс обмена 
(перестановки) записей с ключами K[i] и K[j] выполнялся правильно. В результате 
таблица окажется разбитой на левую часть с ключами меньше или равными X, и 
правую - с ключами больше X.<BR>Для каждой из полученных частей процесс 
повторяется.<BR></P></BODY></HTML>
